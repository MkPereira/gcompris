%define ver      	@VERSION@
%define RELEASE 	1
%define rel     	%{?CUSTOM_RELEASE} %{!?CUSTOM_RELEASE:%RELEASE}
%define verassetml     	1.0
%define prefix		/usr
%define canvaspackage	%(if rpm -q redhat-release &> /dev/null; then echo gdk-pixbuf-gnome; elif rpm -q mandrake-release &> /dev/null; then echo gdk-pixbuf-gnomecanvas; else echo; fi)

Summary: GCompris / I Have Understood.
Name: 		gcompris
Version: 	%ver
Release: 	%rel
Copyright: 	GPL
Group: 		Amusements/Games
Source:		ftp://gcompris.sourceforge.net/gcompris-%{PACKAGE_VERSION}.tgz
BuildRoot: 	/var/tmp/gcompris-%{PACKAGE_VERSION}-root
URL: 		http://ofset.sf.net/gcompris
Docdir: 	%{prefix}/share/doc/gcompris-%{PACKAGE_VERSION}
Requires:	gnome-libs libxml2 gdk-pixbuf %canvaspackage
Requires:       gnuchess >= 5.02
Requires:       python gnome-python gnome-python-canvas pygtk2.0
Requires:       gcompris-libassetml
Packager:       Bruno Coudoin <bcoudoin.coudoin@free.fr>

%description
GCompris / I Have Understood is an educationnal game for children starting at 3.
Today several Boards are implemented:
* Click on the animals => learn the mouse/click usage
* Type the falling letters => learn the keyboard usage
* Falling Dices
* Falling words
* Basic algebra
* Time learning with an analog clock
* Puzzle game with famous paintings
* Drive Plane to catch clouds in increasing number
* Balance the scales
* And much more ...

The Game is included in the Gnome Desktop under the Game menu.

You should install it only if you have children using this computer.

%description -l fr
GCompris / J'ai Compris est un logiciel éducatif pour les enfants 
à partir de 3 ans.

Aujourd'hui, plusieurs tableaux sont implémentés :
* Cliquer sur les animaux => apprentissage du click et de la souris
* Entrer les lettres qui tombent => Apprentissage du clavier
* Les dés qui tombent
* Les mots qui tombent
* Algèbre simple
* Apprentissage de la lecture de l'heure sur une horloge analogique
* Puzzle avec des tableaux célèbres
* Pilote un avion pour attraper les nuages dans l'ordre
* Equilibre la balance

Le jeu est inclus dans le bureau Gnome sous le menu Jeux.

À installer si vous avez des enfants utilisant cet ordinateur.

%changelog
* Thu Feb 06 2003  Bruno Coudoin <bruno.coudoin@free.fr>
- Added the money board
- Added the traffic board
- Added more translation
- Better graphics
- Code cleanup and bugfixes
- Added portuguese speech

%package sounds-fr
Summary:        French sounds for GCompris
Group: 		Amusements/Games
Requires:       %name

%description sounds-fr
French sounds for gcompris.

%package sounds-es
Summary:        Spanish sounds for GCompris
Group: 		Amusements/Games
Requires:       %name

%description sounds-es
Spanish sounds for gcompris.

%package sounds-de
Summary:        German sounds for GCompris
Group: 		Amusements/Games
Requires:       %name

%description sounds-de
German sounds for gcompris.

%package sounds-en
Summary:        English sounds for GCompris
Group: 		Amusements/Games
Requires:       %name

%description sounds-en
English sounds for gcompris.

%package sounds-pt
Summary:        Portuguese sounds for GCompris
Group: 		Amusements/Games
Requires:       %name

%description sounds-pt
Portuguese sounds for gcompris.

%package libassetml
Summary:        Library assetml to share image and audio file between project
Group: 		System/Libraries
Version: 	%verassetml
Requires:       libxml2 glib

%description libassetml
AssetML Library

%package libassetml-devel
Summary:        Devel Library assetml to share image and audio file between project
Group: 		System/Libraries
Version: 	%verassetml
Requires:       libassetml

%description libassetml-devel
AssetML Devel Library

%prep
%setup -q

%build
%ifarch alpha
  MYARCH_FLAGS="--host=alpha-redhat-linux"
%endif

CFLAGS="$RPM_OPT_FLAGS" ./configure --quiet $MYARCH_FLAGS --prefix=%{prefix} \
	 --localstatedir=/var/lib

if [ "$SMP" != "" ]; then
  make -j$SMP MAKE="make -j$SMP"
else
  make
fi

%install
rm -rf $RPM_BUILD_ROOT

make prefix=$RPM_BUILD_ROOT%{prefix} install >install.log 2>&1

%clean
rm -rf $RPM_BUILD_ROOT

%post 

%postun 

%files
%defattr(-, root, root)
%doc ABOUT-NLS AUTHORS COPYING ChangeLog INSTALL NEWS README TODO THANKS
%attr(-, root, games) %{prefix}/bin/*
%{prefix}/lib/gcompris
%{prefix}/lib/menu/*
%dir %{prefix}/share/gcompris
%dir %{prefix}/share/gcompris/boards
%dir %{prefix}/share/gcompris/boards/skins
%{prefix}/share/gcompris/boards/skins/*
%{prefix}/share/gcompris/boards/skins/*/*
%{prefix}/share/gcompris/boards/[^s]*
%{prefix}/share/gcompris/boards/s[cmu]*
%dir %{prefix}/share/gcompris/boards/sounds
%{prefix}/share/gcompris/boards/sounds/*
%{prefix}/share/gnome/apps/Games/*
%{prefix}/share/gnome/help/*
%{prefix}/info/*
%{prefix}/share/locale/*/*/*
%{prefix}/share/pixmaps/*

%files sounds-de
%defattr(-, root, root)
%{prefix}/share/gcompris/boards/sounds/de

%files sounds-en
%defattr(-, root, root)
%{prefix}/share/gcompris/boards/sounds/en

%files sounds-es
%defattr(-, root, root)
%{prefix}/share/gcompris/boards/sounds/es

%files sounds-fr
%defattr(-, root, root)
%{prefix}/share/gcompris/boards/sounds/fr

%files sounds-pt
%defattr(-, root, root)
%{prefix}/share/gcompris/boards/sounds/pt

%files libassetml
%defattr(-, root, root)
%{prefix}/lib/libassetml.so.*
%{prefix}/bin/assetml-query

%files libassetml-devel
%defattr(-, root, root)
%{prefix}/lib/lib*.so
%{prefix}/lib/*a
%{prefix}/include/libassetml*/*
%{prefix}/lib/pkgconfig/libassetml.pc
